<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¬¸ì œ 2-2ë²ˆ</title>
</head>

<style>
    #nextPage {
        display: flex;
        justify-content: center;
        margin-top: 50px;
    }
    #nextPage button {
        padding: 20px 40px;
        font-size: 20px;
    }
</style>

<body>
    <div class="container">
        <h1>ë‚ ì”¨ ê¸°í˜¸ ê¸°ì–µí•˜ê¸°</h1>
        <p>ì•ì„œ ê¸°ì–µí•´ ë‘” <span class="highlight">ë‚ ì”¨ ê¸°í˜¸</span>ë¥¼ ë– ì˜¬ë¦¬ë©° ë¬¸ì œë¥¼ í’€ì–´ë³´ì„¸ìš”(1~5).</p>
        
        <div id="weather"></div>

        <div class="questions">
            <div class="question">
                <label for="answer1">1. ëˆˆì´ ì˜¤ëŠ” ì§€ì—­ì€ ì–´ë””ì¼ê¹Œìš”?</label>
                <input type="text" id="answer1">
            </div>
            <div class="question">
                <label for="answer2">2. ë¹„ê°€ ì˜¤ëŠ” ì§€ì—­ì€ ì–´ë””ì¼ê¹Œìš”?</label>
                <input type="text" id="answer2">
            </div>
            <div class="question">
                <label for="answer3">3. ì•ˆê°œ ë‚€ ì§€ì—­ì€ ì–´ë””ì¼ê¹Œìš”?</label>
                <input type="text" id="answer3">
            </div>
            <div class="question">
                <label for="answer4">4. ë§‘ì€ ë‚ ì”¨ë¥¼ ë³´ì´ëŠ” ì§€ì—­ì€ ì–´ë””ì¼ê¹Œìš”?</label>
                <input type="text" id="answer4">
            </div>
            <div class="question">
                <label for="answer5">5. ì¼ê¸°ì˜ˆë³´ë¡œ ê³ ë ¤í–ˆì„ ë•Œ, í˜„ì¬ëŠ” ë¬´ìŠ¨ ê³„ì ˆì¼ê¹Œìš”?</label>
                <input type="text" id="answer5">
            </div>
        </div>

        <div class="note">ë‚ ì”¨ ê¸°í˜¸ë¥¼ ê¸°ì–µí•´ ì£¼ì„¸ìš”.</div>

        <div class="button-container">
            <button type="button" id="correctbutton">ì •ë‹µ í™•ì¸</button>
        </div>

        <div id="results"></div>

        <div id="nextPage">
            <button>â­ï¸</button>
        </div>
    </div>

    <script>
        const apiKey = '8f7b365bda2da68e3983adf27c328085';
        const citiesEnglish = ['Gunsan', 'Jeonju', 'Mokpo', 'Yeosu', 'Yongin', 'Suwon', 'Pyeongtaek', 'Seongnam', 'Pohang', 'Gyeongju', 'Busan', 'Daegu'];
        const citiesKorean = {
            'Gunsan': 'êµ°ì‚°',
            'Jeonju': 'ì „ì£¼',
            'Mokpo': 'ëª©í¬',
            'Yeosu': 'ì—¬ìˆ˜',
            'Yongin': 'ìš©ì¸',
            'Suwon': 'ìˆ˜ì›',
            'Pyeongtaek': 'í‰íƒ',
            'Seongnam': 'ì„±ë‚¨',
            'Pohang': 'í¬í•­',
            'Gyeongju': 'ê²½ì£¼',
            'Busan': 'ë¶€ì‚°',
            'Daegu': 'ëŒ€êµ¬'
        };
        const weatherData = {};

        function fetchWeather(city) {
            const apiUrl = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric&lang=kr`;

            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    const weatherMain = data.weather[0].main;
                    const celestialObject = mapWeatherToCelestial(weatherMain);
                    weatherData[city] = celestialObject;
                    if (Object.keys(weatherData).length === citiesEnglish.length) {
                        displayWeather();
                    }
                })
                .catch(error => {
                    console.error(`${city} ì§€ì—­ì˜ ë‚ ì”¨ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`, error);
                });
        }

        function displayWeather() {
            const weatherContainer = document.querySelector('#weather');
            const weatherTable = `
                <table>
                    <thead>
                        <tr>
                            <th>êµ°ì‚°</th>
                            <th>ì „ì£¼</th>
                            <th>ëª©í¬</th>
                            <th>ì—¬ìˆ˜</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>${weatherData['Gunsan'] || ''}</td>
                            <td>${weatherData['Jeonju'] || ''}</td>
                            <td>${weatherData['Mokpo'] || ''}</td>
                            <td>${weatherData['Yeosu'] || ''}</td>
                        </tr>
                        <tr>
                            <td>ìš©ì¸</td>
                            <td>ìˆ˜ì›</td>
                            <td>í‰íƒ</td>
                            <td>ì„±ë‚¨</td>
                        </tr>
                        <tr>
                            <td>${weatherData['Yongin'] || ''}</td>
                            <td>${weatherData['Suwon'] || ''}</td>
                            <td>${weatherData['Pyeongtaek'] || ''}</td>
                            <td>${weatherData['Seongnam'] || ''}</td>
                        </tr>
                        <tr>
                            <td>í¬í•­</td>
                            <td>ê²½ì£¼</td>
                            <td>ë¶€ì‚°</td>
                            <td>ëŒ€êµ¬</td>
                        </tr>
                        <tr>
                            <td>${weatherData['Pohang'] || ''}</td>
                            <td>${weatherData['Gyeongju'] || ''}</td>
                            <td>${weatherData['Busan'] || ''}</td>
                            <td>${weatherData['Daegu'] || ''}</td>
                        </tr>
                    </tbody>
                </table>
            `;
            weatherContainer.innerHTML = weatherTable;
        }

        function mapWeatherToCelestial(weatherMain) {
            switch (weatherMain) {
                case 'Clear':
                    return 'â˜€ï¸';
                case 'Clouds':
                    return 'â˜ï¸';
                case 'Rain':
                case 'Drizzle':
                case 'Squall':
                    return 'ğŸŒ§ï¸';
                case 'Thunderstorm':
                    return 'â›ˆï¸';
                case 'Snow':
                    return 'â„ï¸';
                case 'Mist':
                case 'Haze':
                case 'Smoke':
                case 'Fog':
                    return 'ğŸŒ«ï¸';
                case 'Dust':
                case 'Sand':
                case 'Ash':
                    return 'ğŸŒªï¸';
                default:
                    return 'âŒ';
            }
        }

        function getSeason() {
            const month = new Date().getMonth() + 1; 
            let season;

            if (month >= 3 && month <= 5) {
                season = "ë´„";
            } else if (month >= 6 && month <= 8) {
                season = "ì—¬ë¦„";
            } else if (month >= 9 && month <= 11) {
                season = "ê°€ì„";
            } else {
                season = "ê²¨ìš¸";
            }

            return season;
        }

        function evaluateAnswer(input, correctAnswer) {
            return input.trim() === correctAnswer ? 'ì •ë‹µ' : 'ì˜¤ë‹µ';
        }

        function generateResultHTML(question, input, correctAnswer, result) {
            return `<p>${question}: ${correctAnswer} (ì…ë ¥í•œ ë‹µ: ${input}) - ${result}</p>`;
        }

        function checkAnswers() {
            const answer1 = document.querySelector('#answer1').value.trim();
            const answer2 = document.querySelector('#answer2').value.trim();
            const answer3 = document.querySelector('#answer3').value.trim();
            const answer4 = document.querySelector('#answer4').value.trim();
            const answer5 = document.querySelector('#answer5').value.trim();

            const snowCities = [];
            const rainCities = [];
            const fogCities = [];
            const clearCities = [];

            for (const city in weatherData) {
                if (weatherData[city] === 'â„ï¸') snowCities.push(citiesKorean[city]);
                if (weatherData[city] === 'ğŸŒ§ï¸') rainCities.push(citiesKorean[city]);
                if (weatherData[city] === 'ğŸŒ«ï¸') fogCities.push(citiesKorean[city]);
                if (weatherData[city] === 'â˜€ï¸') clearCities.push(citiesKorean[city]);
            }

            const correctAnswers = {
                answer1: snowCities.length > 0 ? snowCities.join(', ') : 'ì—†ìŒ',
                answer2: rainCities.length > 0 ? rainCities.join(', ') : 'ì—†ìŒ',
                answer3: fogCities.length > 0 ? fogCities.join(', ') : 'ì—†ìŒ',
                answer4: clearCities.length > 0 ? clearCities.join(', ') : 'ì—†ìŒ',
                answer5: getSeason()
            };

            const resultsContainer = document.querySelector('#results');
            resultsContainer.innerHTML = `
                ${generateResultHTML('1. ëˆˆì´ ì˜¤ëŠ” ì§€ì—­', answer1, correctAnswers.answer1, evaluateAnswer(answer1, correctAnswers.answer1))}
                ${generateResultHTML('2. ë¹„ê°€ ì˜¤ëŠ” ì§€ì—­', answer2, correctAnswers.answer2, evaluateAnswer(answer2, correctAnswers.answer2))}
                ${generateResultHTML('3. ì•ˆê°œ ë‚€ ì§€ì—­', answer3, correctAnswers.answer3, evaluateAnswer(answer3, correctAnswers.answer3))}
                ${generateResultHTML('4. ë§‘ì€ ë‚ ì”¨ë¥¼ ë³´ì´ëŠ” ì§€ì—­', answer4, correctAnswers.answer4, evaluateAnswer(answer4, correctAnswers.answer4))}
                ${generateResultHTML('5. í˜„ì¬ ê³„ì ˆ', answer5, correctAnswers.answer5, evaluateAnswer(answer5, correctAnswers.answer5))}
            `;
            document.querySelectorAll('.question input').forEach(input => input.value = '');
        }

        document.querySelector('#correctbutton').addEventListener('click', checkAnswers);

        citiesEnglish.forEach(city => {
            fetchWeather(city);
        });

        button = document.querySelector("#nextPage");
        button.addEventListener("click", () => {
            window.open("http://127.0.0.1:5500/%EC%98%88%EC%A0%9C/%EB%AC%B8%EC%A0%9C3%EB%B2%88.html", "_self");
        });
    </script>
</body>
</html>